# Copyright (c) 2014 by Michael Zahniser
#
# Endless Sky is free software: you can redistribute it and/or modify it under the
# terms of the GNU General Public License as published by the Free Software
# Foundation, either version 3 of the License, or (at your option) any later version.
#
# Endless Sky is distributed in the hope that it will be useful, but WITHOUT ANY
# WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A
# PARTICULAR PURPOSE.  See the GNU General Public License for more details.

mission "First Contact: Quarg"
	landing
	source
		attributes "quarg"
	on offer
		conversation
			`You had seen pictures and videos of the Quarg before, but this is your first time in a spaceport that is owned by them. The architecture is truly alien: uncomfortably tall ceilings, strange colors, and walls that never quite seem to meet at right angles. The Quarg themselves are equally strange, towering above you, some nearly three meters tall. Their legs bend backwards at the bottom, like a dog walking on its hind feet, and they move gracefully and almost silently.`
			`	Most of the Quarg you see are dressed entirely in shades of grey, or only slight hints of color. Quarg fashion seems to revolve not around color, but texture: coarse and fine woven fabrics, patterns like lizard scales or cobblestones, and occasional decorative fringes of sponge-like material. Their skin is deep grey, sometimes with a hint of green or blue or brown beneath it, with a fine scale pattern like a reptile. But what makes their eyes startling is that they look very human, except that some of them have gold or violet irises instead of green or blue or brown. They have no hair, but many are wearing small cloth caps or hoods.`
			`	One of the Quarg notices you gawking at them and walks over. It squats down on its haunches so that its eyes are level with your own, and says, "Hello." Its voice is deep, sounding like an accordion or the buzz of a beehive blended with the hum of a starship engine.`
			choice
				`	"Hello."`
			`	Speaking slowly and deliberately, it says, "I think you are new here. Are you what is called a tourist?"`
			choice
				`	"Yes."`
				`	"No, I'm a merchant captain, I'm here to buy and sell cargo."`
			`	"I see." The Quarg blinks slowly. Its eyelids come from the sides of its eyes, instead of up and down. In an otherwise so human eye, the effect is disconcerting. "Many humans have many questions when they see us, and we the Quarg live for many lifetimes of humans, so it is not burdensome for this one to speak with you."`
			
			label choice
			choice
				`	"Can you tell me about the Quarg?"`
					goto quarg
				`	"Are there other alien species in the galaxy?"`
				`	"It is an honor to speak with you, but I do not have any questions."`
					decline
			
			`	"Many. Most of them young, so much younger than the Quarg. Many foolish. A few wise. Many travel only along the ancient roads between the stars. A few need no roads to travel by. And some reshape the galaxy at will. But the Quarg are like no other, because we have nothing that the others covet."`
			choice
				`	"What do you mean?"`
			
			label quarg
			`	"We the Quarg are unique of all the species in the galaxy. Our species began on the moon of a great gas giant, on a planet most small, that gathered about itself very little air. We cannot step many steps on the worlds that the Hai, the Korath, the others species desire. And the worlds like our home, you could not breathe their so thin air, for our lungs are very subtle. And we are an old race, and do not kill for sport or whimsy, so the Drak gave us the gift, that we may go among the other races and settle where we please, and make friends of all, because none dare be our enemy."`
			choice
				`	"Who are the Drak?"`
					goto drak
				`	"Why do none dare to be your enemy?"`
			
			`	"Because we are very strong, and because we speak with the Drak."`
			choice
				`	"Who are the Drak?"`
			
			label drak
			`	"The Drak are the eldest living. Not the firstborn, for they are long gone, but the eldest living, and yet they are far younger than the stars. They tend and cultivate the pathways between the stars, and prune away the paths that any species could travel to make war against another. And they hold the secret of travel beyond those pathways, and give the secret only to a worthy few, so that peace may prevail." It taps its chest with one hand, signaling that the Quarg are among those few.`
			`	"Not that the Drak are strangers to war. Planets and moons and even stars were consumed in their wars and are no more. But then they learned wisdom, and have fought no more wars, many millions of human years. They live nearby, but they keep to themselves, and intervene in the affairs of other races only to prevent their destruction or the use of obscene technologies of war."`
			choice
				`	"We humans have used some rather destructive weapons against each other, and no alien species ever stepped in to put a stop to it."`
				`	"Well, I hope we never do anything bad enough to force them to intervene."`
					goto closing
			
			`	"You have done what? Awakened the atom? There are weapons far worse than that. Consuming planets. Snuffing out stars. Tearing the flesh of space and time itself. Weapons of chaos I pray your reckless race cannot yet even conceive of. These things will attract the attention of the Drak, because they nearly destroyed this galaxy once, and must not be allowed to do so again."`
			choice
				`	"Well, if there are technologies that dangerous out there, I hope the Drak do continue to succeed in keeping them from being used."`
			
			label closing
			`	"I hope so too, human." The Quarg stands up, towering over you once again. "As long as you are a seeker of peace, you are most welcome on our worlds at any time." It bows to you. You are not sure if that is a Quarg gesture too, or if it is simply imitating a human custom, but you bow in return, and the Quarg walks quietly away.`
				decline

# The first time the player boards a disabled quarg ship, they will trigger this mission.
# The Quarg give them the chance to remain on "friendly" terms if they do not take any technology.
# If the player chooses to loot the ship, their Quarg reputation is set to -1000, and the 
# condition "taken quarg technology" is set, which could be referenced in other missions, 
# but currently causes the player to be followed and observed by occasional "Unknown Watcher" drones. 
mission "First Quarg Boarding Action"
	boarding
	source 
		government Quarg
	on offer 
		conversation 
			`	You've been waiting for this moment for a long time. As far as you know, no human has ever disabled and boarded a Quarg ship. Even after the unfathomable amount of punishment that you unleashed upon it, you keep expecting the alien vessel to spring to life and either destroy you or vanish in a shimmer of blue light...but it seems even the Quarg have their limits. The ship is drifting, apparently without power.`
			`	You lock your ship's boarding clamps into position and inspect the Quarg hull through your instruments, keeping one eye on your long-range scanners for any sign of more Quarg (though considering the way their ships can just materialize out of hyperspace, you don't expect a lot of warning). You identify the alien craft's armaments: fearsome twin beam weapons and powerful missile defense turrets. Of course they aren't fitted onto the standard turret-mounts you're used to seeing on human ships...so removing them without damage may be a challenge. And that's assuming no part of this alien ship explodes in your face.  It looks like the primary beams are at least 60 tons each...you have enough cargo space for those, right?`
			`	A pit forms in your stomach...maybe this was a bad idea.` 
			choice 
				`	(There's no going back now. Keep scanning...look for the best way to slice open the hull.)`
					goto hull
				`	(Maybe it would be easier to capture the ship than to rip it apart. Try scanning the inside of the ship for defensive measures.)`
					goto capture
				`	(Abandon this insane project. No alien technology is worth your life.)`
					# defer the mission to be tried again later and boarded ship is destroyed to prevent re-boarding.
					goto selfdestruct 

			label capture
			`	You tune your sensors to inspect the living areas of the enemy ship, starting at what you're fairly certain is the airlock. It doesn't take long for your heart to sink at what you're seeing. There are literally hundreds of tiny, independent power sources distributed over the ships' internal surfaces. They appear to power some kind of intrusion countermeasures. Maybe with 1000 marines you would have a prayer of capturing this ship. Maybe.`
			choice 
				`	(Ok, keep scanning. Look for a way to open the hull.)`
					goto hull
			
			label hull
			`	You continue scanning the Quarg ship's hull, looking for the best place to cut it open. There's already significant weapon damage - disabling the ship wasn't easy. You identify a few components: engines, what you think is the shield generator, and some kind of...battery? You activate your salvage cutter and open up some access holes, but the components are locked in place with strong energy anchors, and you can't figure out how to cut their power.`
			`	Suddenly your thoughts are interrupted by a flashing light on your ship's comm. It looks like the Quarg want to talk.`
			choice
				`	(Ignore the comm and focus on taking this ship apart.)`
					goto end
				`	(Let's hear what they have to say.)`
					goto listen

			label listen
			`	You see the image of a Quarg on your view screen, its alien features revealing no hint of its emotions- it's mannerisms seem the same as every other Quarg you've seen. You can only assume this is the captain of the ship.`
			`	"Human," it addresses you in a measured tone, "Be warned that you are making a serious error. This one understands that it is only natural for a creature such as you to test itself in battle. However, for one such as you to possess Quarg tools or the Drak's gift is taboo. It can only lead to destruction. Your power has already been shown. Withdraw now and leave this system. Then peace will remain between us."`
			choice 
				`	(Ignore him. You've come too far to stop now. The very fact that the alien is talking to you means salvaging its technology must be possible.)`
					goto end
				`	(Agree and disengage your boarding clamps.)`
					goto peace

			label peace
			`	"You have made a wise choice today, Human. Leave this system and the Quarg will remain at peace with you unless you test us again."`
				goto selfdestruct

			label selfdestruct
			`	As you disengage your boarding clamps and begin to boost away, you see multiple escape pods jettisoning from the Quarg ship.`
				# defer the mission to be tried again later and boarded ship is destroyed to prevent re-boarding.
				depart

			label end
			`	As the Quarg talks, you run the cross-hairs of your salvage cutter over its hull, praying for some inspiration. Then it hits you. The comm signal! It's not coming from anywhere near where you'd expect the bridge to be, and when you look closer you see that the residual energy patterns in the hull subtly shift around that location. You take aim and pull the trigger. As a new hull breach opens up, you see several Quarg bodies being sucked into the vacuum of space.  The comm signal dies...and so do the energy anchors protecting the ship's components.`
			`	Mission accomplished! Your regular salvage equipment can take it from here. It's time to grab everything you can carry and get the heck out of Dodge. You've heard that the Quarg can live for hundreds of years...hopefully they don't hold grudges.`
				# proceed to boarding interface and this mission will never happen again.
				decline

	on defer
		# If the player does not follow through with stealing the outfits, set reputation to exactly 1.  
		"reputation: Quarg" = 1
	on decline 
		# If the player does proceed to boarding, set reputation to -1000 and set a variable that can be used for other mission / dialog triggers even if Quarg reputation changes later.  
		"reputation: Quarg" = -1000
		set "taken quarg technology"
	# The destination doesn't matter - this mission is always deferred or declined. 
	destination Earth
